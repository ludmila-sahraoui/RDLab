

Markdown Conversion:

CNS :  IPsec Lecture

<!-- image -->

## What is IPsec ?

- IPsec is a set of protocols (suite) that cooperate to secure IP communications (at the network layer and above).
- Previously with TLS we secure only the Application Layer.
- Used to setup certain VPNs (secure ones )
- provides mutual auth, integrity, confidentiality , and sometimes nonrepudiation (certificates).
- Its components : AH Authentication Header, to protect the header of the IP, i.e integrity, so that nobody can change the content of the IP header while transit, we are using HMAC so the attacker needs to find the key INTEGRITY ), ESP Encapsulating Security Protocol, to protect the header and encrypt the payload, sometimes we encrypt even the header and then add another header from the outside, i.e hiding the original IP, and this is what VPNs do  CONFIDENTIALITY ) and SAs Security Associations, they are like contracts to tell you which encryption algorithm we gonna use, which integrity function, which key derivation function, the size of the key, the lifetime…..).

- to build the SA s there is a framework called the ISAKMP Internet Security Associations Key Management Protocol) which is implemented using a protocol called IKEv1 and IKEv2.
- from IKEv1 to IKEv2  to achieve less messages with better security.
- An interesting thing in IPsec : in one traffic direction (eg, outbound) I use a set of algorithms to encrypt and … while we can use a different set of algorithms for the inbound traffic also with a lifetime.
- IKE runs over UDP 500 , and UDP 4500 NAT-traversal) so that when the packet is Natted it doesn't get dropped due to IP change.
- IPsec aims to stop : Eavesdropping , modification , spoofing of datagrams, even replay of datagrams (it add a nonce, which has a lifetime, which can be measured by time or bytes exchange, this lifetime affects the SA by renegotiating it once nonce is expired), also MITM and session Hijacking due to encryption+ auth, also DoS attacks thanks to anti-spoofing and cookies(just like TCP cookies).
- IPsec supports two operational modes : Transport (by creating a secure channel between two hosts, here there is the problem of the HMAC with NAT, so we use NAT traversal by encapsulating the packet and decapsulation at the end) and Tunnel( this is the story of VPNs , using gateways , it creates a secure channel between gateways, where your original IP will be hidden encrypted (the whole packet is encapsulated once reaching the Gateway), and what is transiting in the channel is encrypted , you can only see the IPs of the gateways)  modes.
- SA is a unidirectional digital contract( a data structure), stores a set of security parameters, algorithms and keys.
- two types of SA  IKE SA Parent SA and IPsec SA (child SA, the first is established to securely establish the second.
- structure contains :
- id called Security parameter Index SPI, in IKE SA it is 6464 bits (half from initiator and half from responder) and in IPsec SA it is 32 bit .
- a sequence number, 0⟶window, after that we have to negotiate a new SA (child SA

- IP protocols in use.
- Encryption also for ESP, propose and select.
- Integrity/hashing algo
- encryption and message authentication keys
- operational mode
- lifetime
- traffic selector IP address range, port range, protocol….)
- in the terminology of IPsec  Responder-Initiator is server-client.

## ISAKMP Phases:

## IKEv1 :

## two main phases :

- Main Mode : exchange 6 packets, in message 1 M1 initiator sends SPI and nonce and proposed algorithms, in message 2  responder sends same and select algorithms from the proposed ones, in M3 and M4 they exchange DH with a nonce to derive key, which is a seed along with the agreed upon PRF Pseudo Random Function) and nonces to derive a set of 3 keys :one for encryption , one for auth and one to be a seed to the Child SA, then M5 , M6 are encrypted to exchange the IDs and auth proofs, hence IKE SA is created now.
- Quick Mode : establishing the Child SA which is encrypted phase by exchange 3 packets, M7 and M8 are for renegotiating the protocols, M9 initiator confirms by a hash on M7 and M8.

## IKEv2 :

## two main phases :

- INIT phase : exchange 2 packets IKESAINIT req and IKESAINIT response), to exchange SPI and nonce and proposed algorithms along with DH public value].SPIs are combined into 128-bit SPI. key is derived, which

is a seed along with the agreed upon PRF Pseudo Random Function) and nonces to derive a set of 3 keys :one for encryption , one for auth and one to be a seed to the Child SA, hence IKE SA is created now.

- AUTH phase : establishing the Child SA which is encrypted phase by exchange 2 packets  IKEAUTH req and IKEAUTH response), no protocols renegotiation , exchanging the IDs and auth proofs with certificates ,a signature over the IKEINIT message or hash with PSK… The IPsec SA is made of two unidirectional Child SAs (one for each traffic direction inbound and outbound), each with its own SPI Security Parameter Index) and
- independent cryptographic parameters (algorithms &amp; keys).

When the Encryption algorithm is : AESGCM no need to specify a hash function , because this encryption algorithm (with Galoi Cyclic Mode) it preforms encryption and integrity. which is not the case when using AESCTR.

To be able to decrypt the IP datagrams, first find the Parent SA, once decrypt it, find Child SAs, then you can decrypt…

## IPSec: Protection with AH and ESP

## Authentication Header (AH):

It guarantees data origin authentication, data freshness, and data integrity. It does not ensure data confidentiality.

AH header in transport mode

<!-- image -->

- We perform the integrity hash on the whole datagram, the AH Header will be considered NULL, and some mutable fields are set to 0 ,like TTL.
- Next Header tells which protocol is next.
- Payload length : length of the AH Header, it is variable depending on the used hash function.
- Seq# to prevent Replay.
- SPI to know which SA is used to decrypt…

AH header in tunnel mode

<!-- image -->

- new IP header is for the Gateway.
- We perform the integrity hash and authentication on the whole datagram, and we care about the Gateway header, bcz there was an attack called CUT&amp;PASTE by cutting the the packet from new IP header which will be replaced by a spoofed one, which my take another route.
- Intigrity check value (multiple of 32 bits in IPv4 HMAC value.

## Encapsulating Security Payload (ESP)

It provides origin authenticity through source authentication, data integrity through hash functions and confidentiality through encryption protection for IP packets.

ESP header in both modes.

<!-- image -->

The interpretation of ESP information fields is as follows:

- ESP header: consists of:
- Security parameter index 32 bits) - (which SA to use here).
- Sequence number 32 bits) for packets freshness.
- ESP trailer:
- Padding 0255 bytes).
- Padding length 8 bits).
- Next header 8 bits).
- ESP Auth: Integrity check value, a multiple of 32 bits.

Not all VPNs use IPsec. There are several other VPN technologies, each with different use cases. E.g., TLS-based VPNs OpenVPN, AnyCon-

## nect, etc) provide encryption of application-layer payload only.

IKEv2 is more efficient, secure, and modern than IKEv1, with fewer exchanges, mandatory PFS, and better support for mobility and rekeying:

- IKEv1 and IKEv2 are not interoperable.
- IKEv1 uses 9 messages, whereas IKEv2 uses 3.
- IKEv2 has DoS protection built-in (using cookie).
- IKEv2 has anti-replay protection mandatory.
- IKEv1 re-negociates SA during Phase 2.
- IKEv2 has perfect forward secrecy (new DH for each child SA.
- IKEv1PSK (aggressive mode) is weaker than IKEv2PSK.
- IKEv2 natively supports ECDH groups.
- IKEv2 supports mobility MOBIKE.

Metadata (as Dict):

{'schema_name': 'DoclingDocument', 'version': '1.3.0', 'name': 'IPsec_Lecture', 'origin': {'mimetype': 'application/pdf', 'binary_hash': 11982162487112626070, 'filename': 'IPsec_Lecture.pdf'}, 'furniture': {'self_ref': '#/furniture', 'children': [], 'content_layer': 'furniture', 'name': '_root_', 'label': 'unspecified'}, 'body': {'self_ref': '#/body', 'children': [{'$ref': '#/pictures/0'}, {'$ref': '#/texts/1'}, {'$ref': '#/groups/0'}, {'$ref': '#/texts/7'}, {'$ref': '#/texts/8'}, {'$ref': '#/groups/1'}, {'$ref': '#/texts/20'}, {'$ref': '#/texts/21'}, {'$ref': '#/groups/2'}, {'$ref': '#/texts/30'}, {'$ref': '#/texts/31'}, {'$ref': '#/texts/32'}, {'$ref': '#/groups/3'}, {'$ref': '#/texts/35'}, {'$ref': '#/texts/36'}, {'$ref': '#/groups/4'}, {'$ref': '#/texts/38'}, {'$ref': '#/texts/39'}, {'$ref': '#/texts/40'}, {'$ref': '#/groups/5'}, {'$ref': '#/texts/43'}, {'$ref': '#/texts/44'}, {'$ref': '#/texts/45'}, {'$ref': '#/texts/46'}, {'$ref': '#/texts/47'}, {'$ref': '#/texts/48'}, {'$ref': '#/texts/49'}, {'$ref': '#/pictures/1'}, {'$ref': '#/groups/6'}, {'$ref': '#/texts/64'}, {'$ref': '#/texts/65'}, {'$ref': '#/pictures/2'}, {'$ref': '#/groups/7'}, {'$ref': '#/texts/76'}, {'$ref': '#/texts/77'}, {'$ref': '#/texts/78'}, {'$ref': '#/texts/79'}, {'$ref': '#/pictures/3'}, {'$ref': '#/texts/84'}, {'$ref': '#/groups/8'}, {'$ref': '#/texts/93'}, {'$ref': '#/texts/94'}, {'$ref': '#/texts/95'}, {'$ref': '#/texts/96'}, {'$ref': '#/texts/97'}, {'$ref': '#/groups/9'}, {'$ref': '#/texts/107'}, {'$ref': '#/texts/108'}], 'content_layer': 'body', 'name': '_root_', 'label': 'unspecified'}, 'groups': [{'self_ref': '#/groups/0', 'parent': {'$ref': '#/body'}, 'children': [{'$ref': '#/texts/2'}, {'$ref': '#/texts/3'}, {'$ref': '#/texts/4'}, {'$ref': '#/texts/5'}, {'$ref': '#/texts/6'}], 'content_layer': 'body', 'name': 'list', 'label': 'list'}, {'self_ref': '#/groups/1', 'parent': {'$ref': '#/body'}, 'children': [{'$ref': '#/texts/9'}, {'$ref': '#/texts/10'}, {'$ref': '#/texts/11'}, {'$ref': '#/texts/12'}, {'$ref': '#/texts/13'}, {'$ref': '#/texts/14'}, {'$ref': '#/texts/15'}, {'$ref': '#/texts/16'}, {'$ref': '#/texts/17'}, {'$ref': '#/texts/18'}, {'$ref': '#/texts/19'}], 'content_layer': 'body', 'name': 'list', 'label': 'list'}, {'self_ref': '#/groups/2', 'parent': {'$ref': '#/body'}, 'children': [{'$ref': '#/texts/22'}, {'$ref': '#/texts/23'}, {'$ref': '#/texts/24'}, {'$ref': '#/texts/25'}, {'$ref': '#/texts/26'}, {'$ref': '#/texts/27'}, {'$ref': '#/texts/28'}, {'$ref': '#/texts/29'}], 'content_layer': 'body', 'name': 'list', 'label': 'list'}, {'self_ref': '#/groups/3', 'parent': {'$ref': '#/body'}, 'children': [{'$ref': '#/texts/33'}, {'$ref': '#/texts/34'}], 'content_layer': 'body', 'name': 'list', 'label': 'list'}, {'self_ref': '#/groups/4', 'parent': {'$ref': '#/body'}, 'children': [{'$ref': '#/texts/37'}], 'content_layer': 'body', 'name': 'list', 'label': 'list'}, {'self_ref': '#/groups/5', 'parent': {'$ref': '#/body'}, 'children': [{'$ref': '#/texts/41'}, {'$ref': '#/texts/42'}], 'content_layer': 'body', 'name': 'list', 'label': 'list'}, {'self_ref': '#/groups/6', 'parent': {'$ref': '#/body'}, 'children': [{'$ref': '#/texts/59'}, {'$ref': '#/texts/60'}, {'$ref': '#/texts/61'}, {'$ref': '#/texts/62'}, {'$ref': '#/texts/63'}], 'content_layer': 'body', 'name': 'list', 'label': 'list'}, {'self_ref': '#/groups/7', 'parent': {'$ref': '#/body'}, 'children': [{'$ref': '#/texts/73'}, {'$ref': '#/texts/74'}, {'$ref': '#/texts/75'}], 'content_layer': 'body', 'name': 'list', 'label': 'list'}, {'self_ref': '#/groups/8', 'parent': {'$ref': '#/body'}, 'children': [{'$ref': '#/texts/85'}, {'$ref': '#/texts/86'}, {'$ref': '#/texts/87'}, {'$ref': '#/texts/88'}, {'$ref': '#/texts/89'}, {'$ref': '#/texts/90'}, {'$ref': '#/texts/91'}, {'$ref': '#/texts/92'}], 'content_layer': 'body', 'name': 'list', 'label': 'list'}, {'self_ref': '#/groups/9', 'parent': {'$ref': '#/body'}, 'children': [{'$ref': '#/texts/98'}, {'$ref': '#/texts/99'}, {'$ref': '#/texts/100'}, {'$ref': '#/texts/101'}, {'$ref': '#/texts/102'}, {'$ref': '#/texts/103'}, {'$ref': '#/texts/104'}, {'$ref': '#/texts/105'}, {'$ref': '#/texts/106'}], 'content_layer': 'body', 'name': 'list', 'label': 'list'}], 'texts': [{'self_ref': '#/texts/0', 'parent': {'$ref': '#/pictures/0'}, 'children': [], 'content_layer': 'body', 'label': 'caption', 'prov': [{'page_no': 1, 'bbox': {'l': 72.0, 't': 519.076, 'r': 361.129, 'b': 491.815, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 20]}], 'orig': 'CNS :  IPsec Lecture', 'text': 'CNS :  IPsec Lecture'}, {'self_ref': '#/texts/1', 'parent': {'$ref': '#/body'}, 'children': [], 'content_layer': 'body', 'label': 'section_header', 'prov': [{'page_no': 1, 'bbox': {'l': 72.0, 't': 419.87, 'r': 233.436, 'b': 399.424, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 15]}], 'orig': 'What is IPsec ?', 'text': 'What is IPsec ?', 'level': 1}, {'self_ref': '#/texts/2', 'parent': {'$ref': '#/groups/0'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 1, 'bbox': {'l': 93.586, 't': 385.98, 'r': 535.477, 'b': 357.076, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 112]}], 'orig': 'IPsec is a set of protocols (suite) that cooperate to secure IP communications (at the network layer and above).', 'text': 'IPsec is a set of protocols (suite) that cooperate to secure IP communications (at the network layer and above).', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/3', 'parent': {'$ref': '#/groups/0'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 1, 'bbox': {'l': 93.586, 't': 343.23, 'r': 420.193, 'b': 332.326, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 57]}], 'orig': 'Previously with TLS we secure only the Application Layer.', 'text': 'Previously with TLS we secure only the Application Layer.', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/4', 'parent': {'$ref': '#/groups/0'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 1, 'bbox': {'l': 93.586, 't': 317.73, 'r': 341.83, 'b': 306.826, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 41]}], 'orig': 'Used to setup certain VPNs (secure ones )', 'text': 'Used to setup certain VPNs (secure ones )', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/5', 'parent': {'$ref': '#/groups/0'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 1, 'bbox': {'l': 93.586, 't': 292.23, 'r': 479.18, 'b': 263.326, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 95]}], 'orig': 'provides mutual auth, integrity, confidentiality , and sometimes nonrepudiation (certificates).', 'text': 'provides mutual auth, integrity, confidentiality , and sometimes nonrepudiation (certificates).', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/6', 'parent': {'$ref': '#/groups/0'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 1, 'bbox': {'l': 93.586, 't': 249.48000000000002, 'r': 543.211, 'b': 94.57600000000002, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 679]}], 'orig': 'Its components : AH \ue081Authentication Header, to protect the header of the IP, i.e integrity, so that nobody can change the content of the IP header while transit, we are using HMAC so the attacker needs to find the key \ue088INTEGRITY\ue088 ), ESP \ue081Encapsulating Security Protocol, to protect the header and encrypt the payload, sometimes we encrypt even the header and then add another header from the outside, i.e hiding the original IP, and this is what VPNs do \ue088 CONFIDENTIALITY\ue088 ) and SAs \ue081Security Associations, they are like contracts to tell you which encryption algorithm we gonna use, which integrity function, which key derivation function, the size of the key, the lifetime…..).', 'text': 'Its components : AH \ue081Authentication Header, to protect the header of the IP, i.e integrity, so that nobody can change the content of the IP header while transit, we are using HMAC so the attacker needs to find the key \ue088INTEGRITY\ue088 ), ESP \ue081Encapsulating Security Protocol, to protect the header and encrypt the payload, sometimes we encrypt even the header and then add another header from the outside, i.e hiding the original IP, and this is what VPNs do \ue088 CONFIDENTIALITY\ue088 ) and SAs \ue081Security Associations, they are like contracts to tell you which encryption algorithm we gonna use, which integrity function, which key derivation function, the size of the key, the lifetime…..).', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/7', 'parent': {'$ref': '#/body'}, 'children': [], 'content_layer': 'furniture', 'label': 'page_footer', 'prov': [{'page_no': 1, 'bbox': {'l': 27.0, 't': 35.456999999999994, 'r': 97.708, 'b': 28.640999999999963, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 19]}], 'orig': 'CNS \ue092 IPsec Lecture', 'text': 'CNS \ue092 IPsec Lecture'}, {'self_ref': '#/texts/8', 'parent': {'$ref': '#/body'}, 'children': [], 'content_layer': 'furniture', 'label': 'page_footer', 'prov': [{'page_no': 1, 'bbox': {'l': 581.941, 't': 35.456999999999994, 'r': 584.992, 'b': 28.640999999999963, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 1]}], 'orig': '1', 'text': '1'}, {'self_ref': '#/texts/9', 'parent': {'$ref': '#/groups/1'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 2, 'bbox': {'l': 93.586, 't': 715.23, 'r': 521.76, 'b': 668.326, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 175]}], 'orig': 'to build the SA s there is a framework called the ISAKMP \ue081Internet Security Associations Key Management Protocol) which is implemented using a protocol called IKEv1 and IKEv2.', 'text': 'to build the SA s there is a framework called the ISAKMP \ue081Internet Security Associations Key Management Protocol) which is implemented using a protocol called IKEv1 and IKEv2.', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/10', 'parent': {'$ref': '#/groups/1'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 2, 'bbox': {'l': 93.586, 't': 653.73, 'r': 477.217, 'b': 642.826, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 68]}], 'orig': 'from IKEv1 to IKEv2 \ue092 to achieve less messages with better security.', 'text': 'from IKEv1 to IKEv2 \ue092 to achieve less messages with better security.', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/11', 'parent': {'$ref': '#/groups/1'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 2, 'bbox': {'l': 93.586, 't': 628.98, 'r': 538.137, 'b': 582.076, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 207]}], 'orig': 'An interesting thing in IPsec : in one traffic direction (eg, outbound) I use a set of algorithms to encrypt and … while we can use a different set of algorithms for the inbound traffic also with a lifetime.', 'text': 'An interesting thing in IPsec : in one traffic direction (eg, outbound) I use a set of algorithms to encrypt and … while we can use a different set of algorithms for the inbound traffic also with a lifetime.', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/12', 'parent': {'$ref': '#/groups/1'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 2, 'bbox': {'l': 93.586, 't': 567.48, 'r': 512.883, 'b': 538.576, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 127]}], 'orig': "IKE runs over UDP 500 , and UDP 4500 \ue081NAT-traversal) so that when the packet is Natted it doesn't get dropped due to IP change.", 'text': "IKE runs over UDP 500 , and UDP 4500 \ue081NAT-traversal) so that when the packet is Natted it doesn't get dropped due to IP change.", 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/13', 'parent': {'$ref': '#/groups/1'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 2, 'bbox': {'l': 93.586, 't': 524.73, 'r': 541.793, 'b': 423.826, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 394]}], 'orig': 'IPsec aims to stop : Eavesdropping , modification , spoofing of datagrams, even replay of datagrams (it add a nonce, which has a lifetime, which can be measured by time or bytes exchange, this lifetime affects the SA by renegotiating it once nonce is expired), also MITM and session Hijacking due to encryption+ auth, also DoS attacks thanks to anti-spoofing and cookies(just like TCP cookies).', 'text': 'IPsec aims to stop : Eavesdropping , modification , spoofing of datagrams, even replay of datagrams (it add a nonce, which has a lifetime, which can be measured by time or bytes exchange, this lifetime affects the SA by renegotiating it once nonce is expired), also MITM and session Hijacking due to encryption+ auth, also DoS attacks thanks to anti-spoofing and cookies(just like TCP cookies).', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/14', 'parent': {'$ref': '#/groups/1'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 2, 'bbox': {'l': 93.586, 't': 409.23, 'r': 542.965, 'b': 272.326, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 543]}], 'orig': 'IPsec supports two operational modes : Transport (by creating a secure channel between two hosts, here there is the problem of the HMAC with NAT, so we use NAT traversal by encapsulating the packet and decapsulation at the end) and Tunnel( this is the story of VPNs , using gateways , it creates a secure channel between gateways, where your original IP will be hidden encrypted (the whole packet is encapsulated once reaching the Gateway), and what is transiting in the channel is encrypted , you can only see the IPs of the gateways)  modes.', 'text': 'IPsec supports two operational modes : Transport (by creating a secure channel between two hosts, here there is the problem of the HMAC with NAT, so we use NAT traversal by encapsulating the packet and decapsulation at the end) and Tunnel( this is the story of VPNs , using gateways , it creates a secure channel between gateways, where your original IP will be hidden encrypted (the whole packet is encapsulated once reaching the Gateway), and what is transiting in the channel is encrypted , you can only see the IPs of the gateways)  modes.', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/15', 'parent': {'$ref': '#/groups/1'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 2, 'bbox': {'l': 93.586, 't': 257.73, 'r': 541.43, 'b': 228.82600000000002, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 117]}], 'orig': 'SA is a unidirectional digital contract( a data structure), stores a set of security parameters, algorithms and keys.', 'text': 'SA is a unidirectional digital contract( a data structure), stores a set of security parameters, algorithms and keys.', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/16', 'parent': {'$ref': '#/groups/1'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 2, 'bbox': {'l': 93.586, 't': 214.98000000000002, 'r': 504.75, 'b': 186.07600000000002, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 120]}], 'orig': 'two types of SA \ue092 IKE SA \ue081Parent SA\ue082 and IPsec SA (child SA\ue082, the first is established to securely establish the second.', 'text': 'two types of SA \ue092 IKE SA \ue081Parent SA\ue082 and IPsec SA (child SA\ue082, the first is established to securely establish the second.', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/17', 'parent': {'$ref': '#/groups/1'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 2, 'bbox': {'l': 93.586, 't': 171.48000000000002, 'r': 206.426, 'b': 160.57600000000002, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 20]}], 'orig': 'structure contains :', 'text': 'structure contains :', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/18', 'parent': {'$ref': '#/groups/1'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 2, 'bbox': {'l': 115.172, 't': 146.73000000000002, 'r': 518.953, 'b': 117.82600000000002, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 145]}], 'orig': 'id called Security parameter Index \ue081SPI\ue082, in IKE SA it is 64\ue09d64 bits (half from initiator and half from responder) and in IPsec SA it is 32 bit .', 'text': 'id called Security parameter Index \ue081SPI\ue082, in IKE SA it is 64\ue09d64 bits (half from initiator and half from responder) and in IPsec SA it is 32 bit .', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/19', 'parent': {'$ref': '#/groups/1'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 2, 'bbox': {'l': 115.172, 't': 103.23000000000002, 'r': 539.93, 'b': 74.32600000000002, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 80]}], 'orig': 'a sequence number, 0⟶window, after that we have to negotiate a new SA (child SA\ue082', 'text': 'a sequence number, 0⟶window, after that we have to negotiate a new SA (child SA\ue082', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/20', 'parent': {'$ref': '#/body'}, 'children': [], 'content_layer': 'furniture', 'label': 'page_footer', 'prov': [{'page_no': 2, 'bbox': {'l': 27.0, 't': 35.456999999999994, 'r': 97.708, 'b': 28.640999999999963, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 19]}], 'orig': 'CNS \ue092 IPsec Lecture', 'text': 'CNS \ue092 IPsec Lecture'}, {'self_ref': '#/texts/21', 'parent': {'$ref': '#/body'}, 'children': [], 'content_layer': 'furniture', 'label': 'page_footer', 'prov': [{'page_no': 2, 'bbox': {'l': 580.418, 't': 35.456999999999994, 'r': 584.992, 'b': 28.640999999999963, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 1]}], 'orig': '2', 'text': '2'}, {'self_ref': '#/texts/22', 'parent': {'$ref': '#/groups/2'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 3, 'bbox': {'l': 115.172, 't': 715.23, 'r': 223.219, 'b': 704.326, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 20]}], 'orig': 'IP protocols in use.', 'text': 'IP protocols in use.', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/23', 'parent': {'$ref': '#/groups/2'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 3, 'bbox': {'l': 115.172, 't': 689.73, 'r': 366.41, 'b': 678.826, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 44]}], 'orig': 'Encryption also for ESP, propose and select.', 'text': 'Encryption also for ESP, propose and select.', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/24', 'parent': {'$ref': '#/groups/2'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 3, 'bbox': {'l': 115.172, 't': 664.98, 'r': 238.002, 'b': 654.076, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 22]}], 'orig': 'Integrity/hashing algo', 'text': 'Integrity/hashing algo', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/25', 'parent': {'$ref': '#/groups/2'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 3, 'bbox': {'l': 115.172, 't': 639.48, 'r': 372.105, 'b': 628.576, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 42]}], 'orig': 'encryption and message authentication keys', 'text': 'encryption and message authentication keys', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/26', 'parent': {'$ref': '#/groups/2'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 3, 'bbox': {'l': 115.172, 't': 614.73, 'r': 214.154, 'b': 603.826, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 16]}], 'orig': 'operational mode', 'text': 'operational mode', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/27', 'parent': {'$ref': '#/groups/2'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 3, 'bbox': {'l': 115.172, 't': 589.23, 'r': 156.41, 'b': 578.326, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 8]}], 'orig': 'lifetime', 'text': 'lifetime', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/28', 'parent': {'$ref': '#/groups/2'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 3, 'bbox': {'l': 115.172, 't': 563.73, 'r': 438.961, 'b': 552.826, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 59]}], 'orig': 'traffic selector \ue081IP address range, port range, protocol….)', 'text': 'traffic selector \ue081IP address range, port range, protocol….)', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/29', 'parent': {'$ref': '#/groups/2'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 3, 'bbox': {'l': 93.586, 't': 538.98, 'r': 455.391, 'b': 528.076, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 67]}], 'orig': 'in the terminology of IPsec \ue092 Responder-Initiator is server-client.', 'text': 'in the terminology of IPsec \ue092 Responder-Initiator is server-client.', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/30', 'parent': {'$ref': '#/body'}, 'children': [], 'content_layer': 'body', 'label': 'section_header', 'prov': [{'page_no': 3, 'bbox': {'l': 72.0, 't': 497.87, 'r': 254.684, 'b': 477.424, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 14]}], 'orig': 'ISAKMP Phases:', 'text': 'ISAKMP Phases:', 'level': 1}, {'self_ref': '#/texts/31', 'parent': {'$ref': '#/body'}, 'children': [], 'content_layer': 'body', 'label': 'section_header', 'prov': [{'page_no': 3, 'bbox': {'l': 72.0, 't': 457.913, 'r': 118.59, 'b': 444.283, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 7]}], 'orig': 'IKEv1 :', 'text': 'IKEv1 :', 'level': 1}, {'self_ref': '#/texts/32', 'parent': {'$ref': '#/body'}, 'children': [], 'content_layer': 'body', 'label': 'section_header', 'prov': [{'page_no': 3, 'bbox': {'l': 72.0, 't': 432.48, 'r': 177.949, 'b': 421.576, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 17]}], 'orig': 'two main phases :', 'text': 'two main phases :', 'level': 1}, {'self_ref': '#/texts/33', 'parent': {'$ref': '#/groups/3'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 3, 'bbox': {'l': 111.586, 't': 406.98, 'r': 540.926, 'b': 270.076, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 518]}], 'orig': 'Main Mode : exchange 6 packets, in message 1 \ue081M1\ue082 initiator sends SPI and nonce and proposed algorithms, in message 2  responder sends same and select algorithms from the proposed ones, in M3 and M4 they exchange DH with a nonce to derive key, which is a seed along with the agreed upon PRF \ue081Pseudo Random Function) and nonces to derive a set of 3 keys :one for encryption , one for auth and one to be a seed to the Child SA, then M5 , M6 are encrypted to exchange the IDs and auth proofs, hence IKE SA is created now.', 'text': 'Main Mode : exchange 6 packets, in message 1 \ue081M1\ue082 initiator sends SPI and nonce and proposed algorithms, in message 2  responder sends same and select algorithms from the proposed ones, in M3 and M4 they exchange DH with a nonce to derive key, which is a seed along with the agreed upon PRF \ue081Pseudo Random Function) and nonces to derive a set of 3 keys :one for encryption , one for auth and one to be a seed to the Child SA, then M5 , M6 are encrypted to exchange the IDs and auth proofs, hence IKE SA is created now.', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/34', 'parent': {'$ref': '#/groups/3'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 3, 'bbox': {'l': 111.586, 't': 256.23, 'r': 521.262, 'b': 209.32600000000002, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 179]}], 'orig': 'Quick Mode : establishing the Child SA which is encrypted phase by exchange 3 packets, M7 and M8 are for renegotiating the protocols, M9 initiator confirms by a hash on M7 and M8.', 'text': 'Quick Mode : establishing the Child SA which is encrypted phase by exchange 3 packets, M7 and M8 are for renegotiating the protocols, M9 initiator confirms by a hash on M7 and M8.', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/35', 'parent': {'$ref': '#/body'}, 'children': [], 'content_layer': 'body', 'label': 'section_header', 'prov': [{'page_no': 3, 'bbox': {'l': 72.0, 't': 188.663, 'r': 121.593, 'b': 175.03300000000002, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 7]}], 'orig': 'IKEv2 :', 'text': 'IKEv2 :', 'level': 1}, {'self_ref': '#/texts/36', 'parent': {'$ref': '#/body'}, 'children': [], 'content_layer': 'body', 'label': 'section_header', 'prov': [{'page_no': 3, 'bbox': {'l': 72.0, 't': 163.23000000000002, 'r': 177.949, 'b': 152.32600000000002, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 17]}], 'orig': 'two main phases :', 'text': 'two main phases :', 'level': 1}, {'self_ref': '#/texts/37', 'parent': {'$ref': '#/groups/4'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 3, 'bbox': {'l': 111.586, 't': 137.73000000000002, 'r': 540.129, 'b': 90.82600000000002, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 212]}], 'orig': 'INIT phase : exchange 2 packets \ue081IKE\ue088SA\ue088INIT req and IKE\ue088SA\ue088INIT response), to exchange SPI and nonce and proposed algorithms along with \ue083DH public value].SPIs are combined into 128-bit SPI. key is derived, which', 'text': 'INIT phase : exchange 2 packets \ue081IKE\ue088SA\ue088INIT req and IKE\ue088SA\ue088INIT response), to exchange SPI and nonce and proposed algorithms along with \ue083DH public value].SPIs are combined into 128-bit SPI. key is derived, which', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/38', 'parent': {'$ref': '#/body'}, 'children': [], 'content_layer': 'furniture', 'label': 'page_footer', 'prov': [{'page_no': 3, 'bbox': {'l': 27.0, 't': 35.456999999999994, 'r': 97.708, 'b': 28.640999999999963, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 19]}], 'orig': 'CNS \ue092 IPsec Lecture', 'text': 'CNS \ue092 IPsec Lecture'}, {'self_ref': '#/texts/39', 'parent': {'$ref': '#/body'}, 'children': [], 'content_layer': 'furniture', 'label': 'page_footer', 'prov': [{'page_no': 3, 'bbox': {'l': 580.359, 't': 35.456999999999994, 'r': 584.992, 'b': 28.640999999999963, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 1]}], 'orig': '3', 'text': '3'}, {'self_ref': '#/texts/40', 'parent': {'$ref': '#/body'}, 'children': [], 'content_layer': 'body', 'label': 'text', 'prov': [{'page_no': 4, 'bbox': {'l': 111.586, 't': 715.23, 'r': 535.441, 'b': 668.326, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 204]}], 'orig': 'is a seed along with the agreed upon PRF \ue081Pseudo Random Function) and nonces to derive a set of 3 keys :one for encryption , one for auth and one to be a seed to the Child SA, hence IKE SA is created now.', 'text': 'is a seed along with the agreed upon PRF \ue081Pseudo Random Function) and nonces to derive a set of 3 keys :one for encryption , one for auth and one to be a seed to the Child SA, hence IKE SA is created now.'}, {'self_ref': '#/texts/41', 'parent': {'$ref': '#/groups/5'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 4, 'bbox': {'l': 111.586, 't': 653.73, 'r': 542.168, 'b': 534.826, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 424]}], 'orig': 'AUTH phase : establishing the Child SA which is encrypted phase by exchange 2 packets  \ue081IKE\ue088AUTH req and IKE\ue088AUTH response), no protocols renegotiation , exchanging the IDs and auth proofs with certificates ,a signature over the IKE\ue088INIT message or hash with PSK… The IPsec SA is made of two unidirectional Child SAs (one for each traffic direction inbound and outbound), each with its own SPI \ue081Security Parameter Index) and', 'text': 'AUTH phase : establishing the Child SA which is encrypted phase by exchange 2 packets  \ue081IKE\ue088AUTH req and IKE\ue088AUTH response), no protocols renegotiation , exchanging the IDs and auth proofs with certificates ,a signature over the IKE\ue088INIT message or hash with PSK… The IPsec SA is made of two unidirectional Child SAs (one for each traffic direction inbound and outbound), each with its own SPI \ue081Security Parameter Index) and', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/42', 'parent': {'$ref': '#/groups/5'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 4, 'bbox': {'l': 111.586, 't': 527.73, 'r': 449.467, 'b': 516.826, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 57]}], 'orig': 'independent cryptographic parameters (algorithms & keys).', 'text': 'independent cryptographic parameters (algorithms & keys).', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/43', 'parent': {'$ref': '#/body'}, 'children': [], 'content_layer': 'body', 'label': 'text', 'prov': [{'page_no': 4, 'bbox': {'l': 89.25, 't': 493.913, 'r': 524.988, 'b': 412.783, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 218]}], 'orig': 'When the Encryption algorithm is : AES\ue088GCM no need to specify a hash function , because this encryption algorithm (with Galoi Cyclic Mode) it preforms encryption and integrity. which is not the case when using AES\ue088CTR.', 'text': 'When the Encryption algorithm is : AES\ue088GCM no need to specify a hash function , because this encryption algorithm (with Galoi Cyclic Mode) it preforms encryption and integrity. which is not the case when using AES\ue088CTR.'}, {'self_ref': '#/texts/44', 'parent': {'$ref': '#/body'}, 'children': [], 'content_layer': 'body', 'label': 'text', 'prov': [{'page_no': 4, 'bbox': {'l': 89.25, 't': 388.913, 'r': 541.582, 'b': 352.783, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 120]}], 'orig': 'To be able to decrypt the IP datagrams, first find the Parent SA, once decrypt it, find Child SAs, then you can decrypt…', 'text': 'To be able to decrypt the IP datagrams, first find the Parent SA, once decrypt it, find Child SAs, then you can decrypt…'}, {'self_ref': '#/texts/45', 'parent': {'$ref': '#/body'}, 'children': [], 'content_layer': 'body', 'label': 'section_header', 'prov': [{'page_no': 4, 'bbox': {'l': 72.0, 't': 288.62, 'r': 437.369, 'b': 268.174, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 33]}], 'orig': 'IPSec: Protection with AH and ESP', 'text': 'IPSec: Protection with AH and ESP', 'level': 1}, {'self_ref': '#/texts/46', 'parent': {'$ref': '#/body'}, 'children': [], 'content_layer': 'body', 'label': 'section_header', 'prov': [{'page_no': 4, 'bbox': {'l': 72.0, 't': 248.663, 'r': 273.815, 'b': 235.03300000000002, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 27]}], 'orig': 'Authentication Header (AH):', 'text': 'Authentication Header (AH):', 'level': 1}, {'self_ref': '#/texts/47', 'parent': {'$ref': '#/body'}, 'children': [], 'content_layer': 'body', 'label': 'text', 'prov': [{'page_no': 4, 'bbox': {'l': 72.0, 't': 223.23000000000002, 'r': 460.107, 'b': 194.32600000000002, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 118]}], 'orig': 'It guarantees data origin authentication, data freshness, and data integrity. It does not ensure data confidentiality.', 'text': 'It guarantees data origin authentication, data freshness, and data integrity. It does not ensure data confidentiality.'}, {'self_ref': '#/texts/48', 'parent': {'$ref': '#/body'}, 'children': [], 'content_layer': 'furniture', 'label': 'page_footer', 'prov': [{'page_no': 4, 'bbox': {'l': 27.0, 't': 35.456999999999994, 'r': 97.708, 'b': 28.640999999999963, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 19]}], 'orig': 'CNS \ue092 IPsec Lecture', 'text': 'CNS \ue092 IPsec Lecture'}, {'self_ref': '#/texts/49', 'parent': {'$ref': '#/body'}, 'children': [], 'content_layer': 'furniture', 'label': 'page_footer', 'prov': [{'page_no': 4, 'bbox': {'l': 580.148, 't': 35.456999999999994, 'r': 584.993, 'b': 28.640999999999963, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 1]}], 'orig': '4', 'text': '4'}, {'self_ref': '#/texts/50', 'parent': {'$ref': '#/pictures/1'}, 'children': [], 'content_layer': 'body', 'label': 'caption', 'prov': [{'page_no': 5, 'bbox': {'l': 201.0, 't': 512.3333333333334, 'r': 418.3333333333333, 'b': 492.0, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 27]}], 'orig': 'AH header in transport mode', 'text': 'AH header in transport mode'}, {'self_ref': '#/texts/51', 'parent': {'$ref': '#/pictures/1'}, 'children': [], 'content_layer': 'body', 'label': 'text', 'prov': [{'page_no': 5, 'bbox': {'l': 122.66666666666666, 't': 561.3333333333334, 'r': 178.66666666666669, 'b': 551.3333333333334, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 11]}], 'orig': 'Next Header', 'text': 'Next Header'}, {'self_ref': '#/texts/52', 'parent': {'$ref': '#/pictures/1'}, 'children': [], 'content_layer': 'body', 'label': 'text', 'prov': [{'page_no': 5, 'bbox': {'l': 189.66666666666669, 't': 561.6666666666666, 'r': 244.33333333333334, 'b': 549.6666666666666, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 11]}], 'orig': 'Payload Len', 'text': 'Payload Len'}, {'self_ref': '#/texts/53', 'parent': {'$ref': '#/pictures/1'}, 'children': [], 'content_layer': 'body', 'label': 'text', 'prov': [{'page_no': 5, 'bbox': {'l': 256.0, 't': 561.3333333333334, 'r': 278.0, 'b': 551.3333333333334, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 3]}], 'orig': 'RSV', 'text': 'RSV'}, {'self_ref': '#/texts/54', 'parent': {'$ref': '#/pictures/1'}, 'children': [], 'content_layer': 'body', 'label': 'text', 'prov': [{'page_no': 5, 'bbox': {'l': 291.66666666666663, 't': 561.6666666666666, 'r': 369.6666666666667, 'b': 549.6666666666666, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 17]}], 'orig': 'SecurityPar Index', 'text': 'SecurityPar Index'}, {'self_ref': '#/texts/55', 'parent': {'$ref': '#/pictures/1'}, 'children': [], 'content_layer': 'body', 'label': 'text', 'prov': [{'page_no': 5, 'bbox': {'l': 379.3333333333333, 't': 561.3333333333334, 'r': 404.6666666666667, 'b': 550.6666666666666, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 4]}], 'orig': 'Seq#', 'text': 'Seq#'}, {'self_ref': '#/texts/56', 'parent': {'$ref': '#/pictures/1'}, 'children': [], 'content_layer': 'body', 'label': 'text', 'prov': [{'page_no': 5, 'bbox': {'l': 425.6666666666667, 't': 561.6666666666666, 'r': 479.6666666666667, 'b': 549.6666666666666, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 10]}], 'orig': 'Keyed Hash', 'text': 'Keyed Hash'}, {'self_ref': '#/texts/57', 'parent': {'$ref': '#/pictures/1'}, 'children': [], 'content_layer': 'body', 'label': 'text', 'prov': [{'page_no': 5, 'bbox': {'l': 175.66666666666669, 't': 539.3333333333334, 'r': 256.33333333333337, 'b': 526.3333333333334, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 20]}], 'orig': 'AH is IP protocol 51', 'text': 'AH is IP protocol 51'}, {'self_ref': '#/texts/58', 'parent': {'$ref': '#/pictures/1'}, 'children': [], 'content_layer': 'body', 'label': 'text', 'prov': [{'page_no': 5, 'bbox': {'l': 331.0, 't': 538.3333333333334, 'r': 441.0, 'b': 526.3333333333334, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 27]}], 'orig': 'AH header is 24 bytes total', 'text': 'AH header is 24 bytes total'}, {'self_ref': '#/texts/59', 'parent': {'$ref': '#/groups/6'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 5, 'bbox': {'l': 93.586, 't': 464.73, 'r': 529.992, 'b': 435.826, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 139]}], 'orig': 'We perform the integrity hash on the whole datagram, the AH Header will be considered NULL, and some mutable fields are set to 0 ,like TTL.', 'text': 'We perform the integrity hash on the whole datagram, the AH Header will be considered NULL, and some mutable fields are set to 0 ,like TTL.', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/60', 'parent': {'$ref': '#/groups/6'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 5, 'bbox': {'l': 93.586, 't': 421.98, 'r': 322.717, 'b': 411.076, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 41]}], 'orig': 'Next Header tells which protocol is next.', 'text': 'Next Header tells which protocol is next.', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/61', 'parent': {'$ref': '#/groups/6'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 5, 'bbox': {'l': 93.586, 't': 396.48, 'r': 536.59, 'b': 367.576, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 93]}], 'orig': 'Payload length : length of the AH Header, it is variable depending on the used hash function.', 'text': 'Payload length : length of the AH Header, it is variable depending on the used hash function.', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/62', 'parent': {'$ref': '#/groups/6'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 5, 'bbox': {'l': 93.586, 't': 353.73, 'r': 228.34, 'b': 342.826, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 23]}], 'orig': 'Seq# to prevent Replay.', 'text': 'Seq# to prevent Replay.', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/63', 'parent': {'$ref': '#/groups/6'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 5, 'bbox': {'l': 93.586, 't': 328.23, 'r': 332.713, 'b': 317.326, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 40]}], 'orig': 'SPI to know which SA is used to decrypt…', 'text': 'SPI to know which SA is used to decrypt…', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/64', 'parent': {'$ref': '#/body'}, 'children': [], 'content_layer': 'furniture', 'label': 'page_footer', 'prov': [{'page_no': 5, 'bbox': {'l': 27.0, 't': 35.456999999999994, 'r': 97.708, 'b': 28.640999999999963, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 19]}], 'orig': 'CNS \ue092 IPsec Lecture', 'text': 'CNS \ue092 IPsec Lecture'}, {'self_ref': '#/texts/65', 'parent': {'$ref': '#/body'}, 'children': [], 'content_layer': 'furniture', 'label': 'page_footer', 'prov': [{'page_no': 5, 'bbox': {'l': 580.43, 't': 35.456999999999994, 'r': 584.989, 'b': 28.640999999999963, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 1]}], 'orig': '5', 'text': '5'}, {'self_ref': '#/texts/66', 'parent': {'$ref': '#/pictures/2'}, 'children': [], 'content_layer': 'body', 'label': 'caption', 'prov': [{'page_no': 6, 'bbox': {'l': 195.33333333333334, 't': 511.33333333333337, 'r': 398.0, 'b': 494.0, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 24]}], 'orig': 'AH header in tunnel mode', 'text': 'AH header in tunnel mode'}, {'self_ref': '#/texts/67', 'parent': {'$ref': '#/pictures/2'}, 'children': [], 'content_layer': 'body', 'label': 'text', 'prov': [{'page_no': 6, 'bbox': {'l': 243.33333333333334, 't': 558.6666666666666, 'r': 264.66666666666663, 'b': 548.6666666666666, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 3]}], 'orig': 'RSV', 'text': 'RSV'}, {'self_ref': '#/texts/68', 'parent': {'$ref': '#/pictures/2'}, 'children': [], 'content_layer': 'body', 'label': 'text', 'prov': [{'page_no': 6, 'bbox': {'l': 278.33333333333337, 't': 559.0, 'r': 355.0, 'b': 547.0, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 17]}], 'orig': 'SecurityPar Index', 'text': 'SecurityPar Index'}, {'self_ref': '#/texts/69', 'parent': {'$ref': '#/pictures/2'}, 'children': [], 'content_layer': 'body', 'label': 'text', 'prov': [{'page_no': 6, 'bbox': {'l': 363.6666666666667, 't': 559.3333333333334, 'r': 389.6666666666667, 'b': 546.6666666666666, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 4]}], 'orig': 'Seq#', 'text': 'Seq#'}, {'self_ref': '#/texts/70', 'parent': {'$ref': '#/pictures/2'}, 'children': [], 'content_layer': 'body', 'label': 'text', 'prov': [{'page_no': 6, 'bbox': {'l': 409.6666666666667, 't': 559.0, 'r': 463.6666666666667, 'b': 546.3333333333334, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 10]}], 'orig': 'Keyed Hash', 'text': 'Keyed Hash'}, {'self_ref': '#/texts/71', 'parent': {'$ref': '#/pictures/2'}, 'children': [], 'content_layer': 'body', 'label': 'text', 'prov': [{'page_no': 6, 'bbox': {'l': 163.66666666666669, 't': 537.0, 'r': 243.0, 'b': 523.6666666666666, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 20]}], 'orig': 'AH is IP protocol 51', 'text': 'AH is IP protocol 51'}, {'self_ref': '#/texts/72', 'parent': {'$ref': '#/pictures/2'}, 'children': [], 'content_layer': 'body', 'label': 'text', 'prov': [{'page_no': 6, 'bbox': {'l': 317.0, 't': 536.3333333333334, 'r': 425.0, 'b': 523.6666666666666, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 27]}], 'orig': 'AH header is 24 bytes total', 'text': 'AH header is 24 bytes total'}, {'self_ref': '#/texts/73', 'parent': {'$ref': '#/groups/7'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 6, 'bbox': {'l': 93.586, 't': 465.48, 'r': 283.617, 'b': 454.576, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 33]}], 'orig': 'new IP header is for the Gateway.', 'text': 'new IP header is for the Gateway.', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/74', 'parent': {'$ref': '#/groups/7'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 6, 'bbox': {'l': 93.586, 't': 440.73, 'r': 536.473, 'b': 375.826, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 265]}], 'orig': 'We perform the integrity hash and authentication on the whole datagram, and we care about the Gateway header, bcz there was an attack called CUT&PASTE by cutting the the packet from new IP header which will be replaced by a spoofed one, which my take another route.', 'text': 'We perform the integrity hash and authentication on the whole datagram, and we care about the Gateway header, bcz there was an attack called CUT&PASTE by cutting the the packet from new IP header which will be replaced by a spoofed one, which my take another route.', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/75', 'parent': {'$ref': '#/groups/7'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 6, 'bbox': {'l': 93.586, 't': 361.23, 'r': 444.562, 'b': 350.326, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 64]}], 'orig': 'Intigrity check value (multiple of 32 bits in IPv4\ue082\ue092 HMAC value.', 'text': 'Intigrity check value (multiple of 32 bits in IPv4\ue082\ue092 HMAC value.', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/76', 'parent': {'$ref': '#/body'}, 'children': [], 'content_layer': 'body', 'label': 'section_header', 'prov': [{'page_no': 6, 'bbox': {'l': 72.0, 't': 304.913, 'r': 339.812, 'b': 291.283, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 36]}], 'orig': 'Encapsulating Security Payload (ESP)', 'text': 'Encapsulating Security Payload (ESP)', 'level': 1}, {'self_ref': '#/texts/77', 'parent': {'$ref': '#/body'}, 'children': [], 'content_layer': 'body', 'label': 'text', 'prov': [{'page_no': 6, 'bbox': {'l': 72.0, 't': 279.48, 'r': 543.141, 'b': 250.57600000000002, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 166]}], 'orig': 'It provides origin authenticity through source authentication, data integrity through hash functions and confidentiality through encryption protection for IP packets.', 'text': 'It provides origin authenticity through source authentication, data integrity through hash functions and confidentiality through encryption protection for IP packets.'}, {'self_ref': '#/texts/78', 'parent': {'$ref': '#/body'}, 'children': [], 'content_layer': 'furniture', 'label': 'page_footer', 'prov': [{'page_no': 6, 'bbox': {'l': 27.0, 't': 35.456999999999994, 'r': 97.708, 'b': 28.640999999999963, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 19]}], 'orig': 'CNS \ue092 IPsec Lecture', 'text': 'CNS \ue092 IPsec Lecture'}, {'self_ref': '#/texts/79', 'parent': {'$ref': '#/body'}, 'children': [], 'content_layer': 'furniture', 'label': 'page_footer', 'prov': [{'page_no': 6, 'bbox': {'l': 580.348, 't': 35.456999999999994, 'r': 584.999, 'b': 28.640999999999963, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 1]}], 'orig': '6', 'text': '6'}, {'self_ref': '#/texts/80', 'parent': {'$ref': '#/pictures/3'}, 'children': [], 'content_layer': 'body', 'label': 'caption', 'prov': [{'page_no': 7, 'bbox': {'l': 193.33333333333334, 't': 499.0, 'r': 409.3333333333333, 'b': 480.66666666666663, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 25]}], 'orig': 'ESP header in both modes.', 'text': 'ESP header in both modes.'}, {'self_ref': '#/texts/81', 'parent': {'$ref': '#/pictures/3'}, 'children': [], 'content_layer': 'body', 'label': 'text', 'prov': [{'page_no': 7, 'bbox': {'l': 329.6666666666667, 't': 542.3333333333334, 'r': 375.0, 'b': 529.0, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 10]}], 'orig': 'Encryption', 'text': 'Encryption'}, {'self_ref': '#/texts/82', 'parent': {'$ref': '#/pictures/3'}, 'children': [], 'content_layer': 'body', 'label': 'text', 'prov': [{'page_no': 7, 'bbox': {'l': 281.33333333333337, 't': 525.3333333333334, 'r': 342.0, 'b': 514.6666666666666, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 14]}], 'orig': 'Authentication', 'text': 'Authentication'}, {'self_ref': '#/texts/83', 'parent': {'$ref': '#/pictures/3'}, 'children': [], 'content_layer': 'body', 'label': 'text', 'prov': [{'page_no': 7, 'bbox': {'l': 183.6521212998096, 't': 703.2871511907043, 'r': 203.34787870019036, 'b': 688.3795154759623, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 4]}], 'orig': 'Orig', 'text': 'Orig'}, {'self_ref': '#/texts/84', 'parent': {'$ref': '#/body'}, 'children': [], 'content_layer': 'body', 'label': 'text', 'prov': [{'page_no': 7, 'bbox': {'l': 72.0, 't': 436.98, 'r': 392.344, 'b': 426.076, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 59]}], 'orig': 'The interpretation of ESP information fields is as follows:', 'text': 'The interpretation of ESP information fields is as follows:'}, {'self_ref': '#/texts/85', 'parent': {'$ref': '#/groups/8'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 7, 'bbox': {'l': 93.586, 't': 412.23, 'r': 231.504, 'b': 401.326, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 24]}], 'orig': 'ESP header: consists of:', 'text': 'ESP header: consists of:', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/86', 'parent': {'$ref': '#/groups/8'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 7, 'bbox': {'l': 115.172, 't': 386.73, 'r': 459.539, 'b': 375.826, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 60]}], 'orig': 'Security parameter index \ue08132 bits) - (which SA to use here).', 'text': 'Security parameter index \ue08132 bits) - (which SA to use here).', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/87', 'parent': {'$ref': '#/groups/8'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 7, 'bbox': {'l': 115.172, 't': 361.23, 'r': 399.65, 'b': 350.326, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 48]}], 'orig': 'Sequence number \ue08132 bits) for packets freshness.', 'text': 'Sequence number \ue08132 bits) for packets freshness.', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/88', 'parent': {'$ref': '#/groups/8'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 7, 'bbox': {'l': 93.586, 't': 336.48, 'r': 155.502, 'b': 325.576, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 12]}], 'orig': 'ESP trailer:', 'text': 'ESP trailer:', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/89', 'parent': {'$ref': '#/groups/8'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 7, 'bbox': {'l': 115.172, 't': 310.98, 'r': 246.352, 'b': 300.076, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 22]}], 'orig': 'Padding \ue0810\ue088255 bytes).', 'text': 'Padding \ue0810\ue088255 bytes).', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/90', 'parent': {'$ref': '#/groups/8'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 7, 'bbox': {'l': 115.172, 't': 286.23, 'r': 247.154, 'b': 275.326, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 24]}], 'orig': 'Padding length \ue0818 bits).', 'text': 'Padding length \ue0818 bits).', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/91', 'parent': {'$ref': '#/groups/8'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 7, 'bbox': {'l': 115.172, 't': 260.73, 'r': 231.615, 'b': 249.82600000000002, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 21]}], 'orig': 'Next header \ue0818 bits).', 'text': 'Next header \ue0818 bits).', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/92', 'parent': {'$ref': '#/groups/8'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 7, 'bbox': {'l': 93.586, 't': 235.23000000000002, 'r': 393.381, 'b': 224.32600000000002, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 55]}], 'orig': 'ESP Auth: Integrity check value, a multiple of 32 bits.', 'text': 'ESP Auth: Integrity check value, a multiple of 32 bits.', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/93', 'parent': {'$ref': '#/body'}, 'children': [], 'content_layer': 'body', 'label': 'text', 'prov': [{'page_no': 7, 'bbox': {'l': 89.25, 't': 176.663, 'r': 463.535, 'b': 140.53300000000002, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 70]}, {'page_no': 7, 'bbox': {'l': 89.25, 't': 176.663, 'r': 463.535, 'b': 140.53300000000002, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [71, 135]}], 'orig': 'Not all VPNs use IPsec. There are several other VPN technologies, each with different use cases. E.g., TLS-based VPNs \ue081OpenVPN, AnyCon-', 'text': 'Not all VPNs use IPsec. There are several other VPN technologies, each with different use cases. E.g., TLS-based VPNs \ue081OpenVPN, AnyCon-'}, {'self_ref': '#/texts/94', 'parent': {'$ref': '#/body'}, 'children': [], 'content_layer': 'furniture', 'label': 'page_footer', 'prov': [{'page_no': 7, 'bbox': {'l': 27.0, 't': 35.456999999999994, 'r': 97.708, 'b': 28.640999999999963, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 19]}], 'orig': 'CNS \ue092 IPsec Lecture', 'text': 'CNS \ue092 IPsec Lecture'}, {'self_ref': '#/texts/95', 'parent': {'$ref': '#/body'}, 'children': [], 'content_layer': 'furniture', 'label': 'page_footer', 'prov': [{'page_no': 7, 'bbox': {'l': 580.746, 't': 35.456999999999994, 'r': 584.99, 'b': 28.640999999999963, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 1]}], 'orig': '7', 'text': '7'}, {'self_ref': '#/texts/96', 'parent': {'$ref': '#/body'}, 'children': [], 'content_layer': 'body', 'label': 'section_header', 'prov': [{'page_no': 8, 'bbox': {'l': 89.25, 't': 714.413, 'r': 534.387, 'b': 700.783, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 64]}], 'orig': 'nect, etc) provide encryption of application-layer payload only.', 'text': 'nect, etc) provide encryption of application-layer payload only.', 'level': 1}, {'self_ref': '#/texts/97', 'parent': {'$ref': '#/body'}, 'children': [], 'content_layer': 'body', 'label': 'text', 'prov': [{'page_no': 8, 'bbox': {'l': 72.0, 't': 653.73, 'r': 473.115, 'b': 624.826, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 138]}], 'orig': 'IKEv2 is more efficient, secure, and modern than IKEv1, with fewer exchanges, mandatory PFS, and better support for mobility and rekeying:', 'text': 'IKEv2 is more efficient, secure, and modern than IKEv1, with fewer exchanges, mandatory PFS, and better support for mobility and rekeying:'}, {'self_ref': '#/texts/98', 'parent': {'$ref': '#/groups/9'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 8, 'bbox': {'l': 93.586, 't': 610.23, 'r': 309.205, 'b': 599.326, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 38]}], 'orig': 'IKEv1 and IKEv2 are not interoperable.', 'text': 'IKEv1 and IKEv2 are not interoperable.', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/99', 'parent': {'$ref': '#/groups/9'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 8, 'bbox': {'l': 93.586, 't': 585.48, 'r': 360.932, 'b': 574.576, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 44]}], 'orig': 'IKEv1 uses 9 messages, whereas IKEv2 uses 3.', 'text': 'IKEv1 uses 9 messages, whereas IKEv2 uses 3.', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/100', 'parent': {'$ref': '#/groups/9'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 8, 'bbox': {'l': 93.586, 't': 559.98, 'r': 367.992, 'b': 549.076, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 49]}], 'orig': 'IKEv2 has DoS protection built-in (using cookie).', 'text': 'IKEv2 has DoS protection built-in (using cookie).', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/101', 'parent': {'$ref': '#/groups/9'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 8, 'bbox': {'l': 93.586, 't': 535.23, 'r': 342.316, 'b': 524.326, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 43]}], 'orig': 'IKEv2 has anti-replay protection mandatory.', 'text': 'IKEv2 has anti-replay protection mandatory.', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/102', 'parent': {'$ref': '#/groups/9'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 8, 'bbox': {'l': 93.586, 't': 509.73, 'r': 317.783, 'b': 498.826, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 38]}], 'orig': 'IKEv1 re-negociates SA during Phase 2.', 'text': 'IKEv1 re-negociates SA during Phase 2.', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/103', 'parent': {'$ref': '#/groups/9'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 8, 'bbox': {'l': 93.586, 't': 484.23, 'r': 450.146, 'b': 473.326, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 61]}], 'orig': 'IKEv2 has perfect forward secrecy (new DH for each child SA\ue082.', 'text': 'IKEv2 has perfect forward secrecy (new DH for each child SA\ue082.', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/104', 'parent': {'$ref': '#/groups/9'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 8, 'bbox': {'l': 93.586, 't': 459.48, 'r': 415.764, 'b': 448.576, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 53]}], 'orig': 'IKEv1\ue088PSK (aggressive mode) is weaker than IKEv2\ue088PSK.', 'text': 'IKEv1\ue088PSK (aggressive mode) is weaker than IKEv2\ue088PSK.', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/105', 'parent': {'$ref': '#/groups/9'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 8, 'bbox': {'l': 93.586, 't': 433.98, 'r': 310.354, 'b': 423.076, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 36]}], 'orig': 'IKEv2 natively supports ECDH groups.', 'text': 'IKEv2 natively supports ECDH groups.', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/106', 'parent': {'$ref': '#/groups/9'}, 'children': [], 'content_layer': 'body', 'label': 'list_item', 'prov': [{'page_no': 8, 'bbox': {'l': 93.586, 't': 409.23, 'r': 289.693, 'b': 398.326, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 33]}], 'orig': 'IKEv2 supports mobility \ue081MOBIKE\ue082.', 'text': 'IKEv2 supports mobility \ue081MOBIKE\ue082.', 'enumerated': False, 'marker': '-'}, {'self_ref': '#/texts/107', 'parent': {'$ref': '#/body'}, 'children': [], 'content_layer': 'furniture', 'label': 'page_footer', 'prov': [{'page_no': 8, 'bbox': {'l': 27.0, 't': 35.456999999999994, 'r': 97.708, 'b': 28.640999999999963, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 19]}], 'orig': 'CNS \ue092 IPsec Lecture', 'text': 'CNS \ue092 IPsec Lecture'}, {'self_ref': '#/texts/108', 'parent': {'$ref': '#/body'}, 'children': [], 'content_layer': 'furniture', 'label': 'page_footer', 'prov': [{'page_no': 8, 'bbox': {'l': 580.359, 't': 35.456999999999994, 'r': 584.999, 'b': 28.640999999999963, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 1]}], 'orig': '8', 'text': '8'}], 'pictures': [{'self_ref': '#/pictures/0', 'parent': {'$ref': '#/body'}, 'children': [{'$ref': '#/texts/0'}], 'content_layer': 'body', 'label': 'picture', 'prov': [{'page_no': 1, 'bbox': {'l': 71.45652770996094, 't': 720.9007186889648, 'r': 540.3262939453125, 'b': 525.3482666015625, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 0]}], 'captions': [{'$ref': '#/texts/0'}], 'references': [], 'footnotes': [], 'annotations': []}, {'self_ref': '#/pictures/1', 'parent': {'$ref': '#/body'}, 'children': [{'$ref': '#/texts/50'}, {'$ref': '#/texts/51'}, {'$ref': '#/texts/52'}, {'$ref': '#/texts/53'}, {'$ref': '#/texts/54'}, {'$ref': '#/texts/55'}, {'$ref': '#/texts/56'}, {'$ref': '#/texts/57'}, {'$ref': '#/texts/58'}], 'content_layer': 'body', 'label': 'picture', 'prov': [{'page_no': 5, 'bbox': {'l': 110.06942749023438, 't': 708.6848068237305, 'r': 505.865966796875, 'b': 523.0604248046875, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 0]}], 'captions': [{'$ref': '#/texts/50'}], 'references': [], 'footnotes': [], 'annotations': []}, {'self_ref': '#/pictures/2', 'parent': {'$ref': '#/body'}, 'children': [{'$ref': '#/texts/66'}, {'$ref': '#/texts/67'}, {'$ref': '#/texts/68'}, {'$ref': '#/texts/69'}, {'$ref': '#/texts/70'}, {'$ref': '#/texts/71'}, {'$ref': '#/texts/72'}], 'content_layer': 'body', 'label': 'picture', 'prov': [{'page_no': 6, 'bbox': {'l': 88.61279296875, 't': 711.2226028442383, 'r': 500.60101318359375, 'b': 520.1351928710938, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 0]}], 'captions': [{'$ref': '#/texts/66'}], 'references': [], 'footnotes': [], 'annotations': []}, {'self_ref': '#/pictures/3', 'parent': {'$ref': '#/body'}, 'children': [{'$ref': '#/texts/80'}, {'$ref': '#/texts/81'}, {'$ref': '#/texts/82'}, {'$ref': '#/texts/83'}], 'content_layer': 'body', 'label': 'picture', 'prov': [{'page_no': 7, 'bbox': {'l': 87.3372802734375, 't': 711.8145599365234, 'r': 517.2293090820312, 'b': 505.8284912109375, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0, 0]}], 'captions': [{'$ref': '#/texts/80'}], 'references': [], 'footnotes': [], 'annotations': []}], 'tables': [], 'key_value_items': [], 'form_items': [], 'pages': {'1': {'size': {'width': 612.0, 'height': 792.0}, 'page_no': 1}, '2': {'size': {'width': 612.0, 'height': 792.0}, 'page_no': 2}, '3': {'size': {'width': 612.0, 'height': 792.0}, 'page_no': 3}, '4': {'size': {'width': 612.0, 'height': 792.0}, 'page_no': 4}, '5': {'size': {'width': 612.0, 'height': 792.0}, 'page_no': 5}, '6': {'size': {'width': 612.0, 'height': 792.0}, 'page_no': 6}, '7': {'size': {'width': 612.0, 'height': 792.0}, 'page_no': 7}, '8': {'size': {'width': 612.0, 'height': 792.0}, 'page_no': 8}}}